<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Tell Us About Your Case - Limitless Law Firm</title>
    <script>
        // Force correct viewport and prevent zoom issues
        (function() {
            var viewport = document.querySelector('meta[name="viewport"]');
            if (viewport) {
                viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover');
            }
        })();
    </script>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <link rel="icon" type="image/png" sizes="192x192" href="../Limitless Law Logo Transparent.jpg">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-content">
                    <a href="/" style="margin-left: -300px; display:inline-block; text-decoration:none;">
                        <img src="../bigger logo.png" alt="Limitless Law Firm Logo" style="height: 60px; margin-bottom: 10px; display: block;">
                    </a>
                    <a href="/" class="logo" style="margin-left: -1000px; text-decoration:none; color:inherit; display:inline-block;">
                        <h1 style="margin:0;">Limitless Law Firm</h1>
                        <p style="margin:0;">Personal Injury Attorneys</p>
                    </a>
                        <ul class="nav-menu">
                            <li><a href="/">Home</a></li>
                            <li><a href="/index.html#contact">Contact</a></li>
                        </ul>
                        <div class="mobile-menu-toggle">
                            <i class="fas fa-bars"></i>
                        </div>
                </div>
            </div>
        </nav>
    </header>

    <main style="margin-top: 140px;">
        <section class="get-started">
            <div class="container">
                <h2 class="section-title">Tell Us About Your Case</h2>
                <p class="get-started-subtitle">Select your case type to continue.</p>
                <div class="case-grid">
                    <button class="case-card" data-value="car-accident"><i class="fas fa-car"></i><span>Car Accident</span></button>
                    <button class="case-card" data-value="truck-accident"><i class="fas fa-truck"></i><span>Truck Accident</span></button>
                    <button class="case-card" data-value="motorcycle-accident"><i class="fas fa-motorcycle"></i><span>Motorcycle Accident</span></button>
                    <button class="case-card" data-value="slip-fall"><i class="fas fa-walking"></i><span>Slip & Fall</span></button>
                    <button class="case-card" data-value="wrongful-death"><i class="fas fa-heart-broken"></i><span>Wrongful Death</span></button>
                    <button class="case-card" data-value="brain-injury"><i class="fas fa-brain"></i><span>Brain Injury</span></button>
                    <button class="case-card" data-value="employment-law"><i class="fas fa-briefcase"></i><span>Employment Law</span></button>
                    <button class="case-card" data-value="dog-bite"><i class="fas fa-dog"></i><span>Dog Bite</span></button>
                    <button class="case-card" data-value="workers-compensation"><i class="fas fa-briefcase"></i><span>Workers' Compensation</span></button>
                </div>
            </div>
        </section>

        <section id="info-step" class="submit-step" style="display:none;">
            <div class="container">
                <h2 class="section-title">Your Information</h2>
                <p class="submit-step-subtitle">Selected case: <strong id="selected-case">â€”</strong></p>
                <form id="info-form" class="contact-form" style="max-width: 720px; margin: 0 auto;">
                    <div class="form-group">
                        <input type="text" id="name" placeholder="Your Name" required>
                    </div>
                    <div class="form-group">
                        <input type="email" id="email" placeholder="Your Email" required>
                    </div>
                    <div class="form-group">
                        <input type="tel" id="phone" placeholder="Your Phone">
                    </div>
                    <div class="form-group">
                        <textarea id="details" rows="5" placeholder="Tell us about your case"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-large">Submit</button>
                </form>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 Limitless Law Firm. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize EmailJS with security and rate limiting
        emailjs.init({
            publicKey: '9L2pz3Q7ya8Z9RLyK',
            // Do not allow headless browsers
            blockHeadless: true,
            blockList: {
                // Block the suspended emails
                list: ['spam@example.com', 'test@example.com'],
                // The variable contains the email address
                watchVariable: 'email',
            },
            limitRate: {
                // Set the limit rate for the application
                id: 'app',
                // Allow 1 request per 10s
                throttle: 10000,
            },
        });
        
        const caseCards = document.querySelectorAll('.case-card');
        const infoStep = document.getElementById('info-step');
        const selectedCaseEl = document.getElementById('selected-case');
        const form = document.getElementById('info-form');

        let selectedValue = '';
        let lastSubmissionTime = 0;
        const SUBMISSION_COOLDOWN = 10000; // 10 seconds in milliseconds

        // Security and validation functions
        function sanitizeInput(input) {
            if (typeof input !== 'string') return '';
            // Remove newlines, carriage returns, and other control characters
            return input.replace(/[<>]/g, '').replace(/[\r\n\t\f\v]/g, '').trim();
        }

        function validateEmail(email) {
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            return emailRegex.test(email);
        }

        function validatePhone(phone) {
            // Remove all non-numeric characters except + at the beginning
            const cleanPhone = phone.replace(/[^\d+]/g, '');
            // Check if it's a valid phone number (7-15 digits, optionally starting with +)
            const phoneRegex = /^(\+?1?)?[2-9]\d{2}[2-9]\d{2}\d{4}$/;
            return phoneRegex.test(cleanPhone) && cleanPhone.length >= 10 && cleanPhone.length <= 15;
        }

        function validateName(name) {
            // Allow letters, spaces, hyphens, and apostrophes
            const nameRegex = /^[a-zA-Z\s\-']{2,50}$/;
            return nameRegex.test(name);
        }

        function validateCaseDescription(description) {
            // Allow letters, numbers, spaces, basic punctuation
            // Limit length to prevent abuse
            const descRegex = /^[a-zA-Z0-9\s.,!?'"():;-]{10,1000}$/;
            return descRegex.test(description);
        }

        caseCards.forEach(card => {
            card.addEventListener('click', function() {
                caseCards.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                selectedValue = this.getAttribute('data-value') || '';
                const label = this.querySelector('span')?.textContent || '';
                selectedCaseEl.textContent = label;
                infoStep.style.display = 'block';
                window.scrollTo({ top: infoStep.offsetTop - 100, behavior: 'smooth' });
            });
        });

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check rate limiting
            const currentTime = Date.now();
            const timeSinceLastSubmission = currentTime - lastSubmissionTime;
            
            if (timeSinceLastSubmission < SUBMISSION_COOLDOWN) {
                const remainingTime = Math.ceil((SUBMISSION_COOLDOWN - timeSinceLastSubmission) / 1000);
                alert(`Please wait ${remainingTime} more seconds before submitting again.`);
                return;
            }
            
            // Validate case type selection
            if (!selectedValue) {
                alert('Please select a case type first.');
                return;
            }
            
            // Get and sanitize form data
            const rawName = document.getElementById('name').value;
            const rawEmail = document.getElementById('email').value;
            const rawPhone = document.getElementById('phone').value;
            const rawDetails = document.getElementById('details').value;
            
            // Debug: Log raw form data
            // console.log('Raw form data:', {
            //     name: rawName,
            //     email: rawEmail,
            //     phone: rawPhone,
            //     details: rawDetails
            // });
            
            const sanitizedName = sanitizeInput(rawName);
            const sanitizedEmail = sanitizeInput(rawEmail);
            const sanitizedPhone = sanitizeInput(rawPhone);
            const sanitizedDetails = sanitizeInput(rawDetails);
            
            // Debug: Log sanitized data
            // console.log('Sanitized data:', {
            //     name: sanitizedName,
            //     email: sanitizedEmail,
            //     phone: sanitizedPhone,
            //     details: sanitizedDetails
            // });
            
            // Validate required fields
            if (!sanitizedName || !sanitizedEmail) {
                alert('Please fill in your name and email.');
                return;
            }
            
            // Validate name
            if (!validateName(sanitizedName)) {
                alert('Please enter a valid name (letters, spaces, hyphens, and apostrophes only, 2-50 characters).');
                return;
            }
            
            // Validate email
            if (!validateEmail(sanitizedEmail)) {
                alert('Please enter a valid email address.');
                return;
            }
            
            // Validate phone (if provided)
            if (sanitizedPhone && !validatePhone(sanitizedPhone)) {
                alert('Please enter a valid phone number (10-15 digits).');
                return;
            }
            
            // Validate case description (if provided)
            if (sanitizedDetails && !validateCaseDescription(sanitizedDetails)) {
                alert('Please enter a valid case description (10-1000 characters, letters, numbers, and basic punctuation only).');
                return;
            }
            
            const submitBtn = form.querySelector('button[type="submit"]');
            const original = submitBtn.textContent;
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;
            
            // Prepare secure data for EmailJS
            const secureFormData = {
                to_email: 'Limitlesslawllp@gmail.com',
                name: sanitizedName,
                email: sanitizedEmail,
                phone: sanitizedPhone || 'Not provided',
                title: document.getElementById('selected-case').textContent,
                message: sanitizedDetails || 'No additional details provided',
                submission_date: new Date().toLocaleDateString(),
                submission_time: new Date().toLocaleTimeString()
            };
            
            // Debug: Log the data being sent
            // console.log('Sending data to EmailJS:', secureFormData);
            
            // Send email via EmailJS with error handling
            emailjs.send('service_fqepr09', 'template_elxmbu6', secureFormData)
            .then(function(response) {
                // console.log('Email sent successfully:', response);
                
                // Record submission time for rate limiting
                lastSubmissionTime = Date.now();
                
                alert('Thank you! We\'ve received your information and will contact you soon.');
                
                // Reset form and UI
                form.reset();
                infoStep.style.display = 'none';
                selectedValue = '';
                caseCards.forEach(c => c.classList.remove('active'));
                
                submitBtn.textContent = original;
                submitBtn.disabled = false;
            })
            .catch(function(error) {
                // console.error('EmailJS Error:', error);
                alert('Sorry, there was an error sending your message. Please try again or call us directly at (818) 465-8795.');
                submitBtn.textContent = original;
                submitBtn.disabled = false;
            });
        });
    });
    </script>
</body>
<\/html>


